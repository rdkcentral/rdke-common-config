# backtrace logging is enabled
# we set this to "y" or "n" and use it as a conditional later

LOG_BACKTRACE = "${@bb.utils.contains('DISTRO_FEATURES', 'logbacktrace', 'y', 'n', d)}"

BACKTRACE_LDFLAGS ?= ""
BACKTRACE_DEPENDS ?= ""

BACKTRACE_DEPENDS:pn-iarmbus = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-iarmmgrs = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-rmfstreamer = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-rmfpodmgr = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-parodus = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-tr69hostif = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-wpeframework = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-wpa-supplicant = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-hdmicec = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-devicesettings = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-trmmgr = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-wsproxy = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-qtapp = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-ledmgr = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-audiocapturemgr = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-audioserver = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-audioserver-soc = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-runpod = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-runsnmp = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-vodclient-app = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-nlmon = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-pwr-state-monitor = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-authservice = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-aml-audio-service = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-asbluetoothrcu  = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-dnsmasq = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-rdkfwupgrader = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-cobaltlauncher = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-libloader-app = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-wpe-webkit = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-dcmd = " breakpad-wrapper"
BACKTRACE_DEPENDS:pn-rfc = " breakpad-wrapper"

BACKTRACE_LDFLAGS:pn-iarmbus = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-iarmmgrs = " -lbreakpadwrapper "
BACKTRACE_LDFLAGS:pn-rmfstreamer = " -lbreakpadwrapper "
BACKTRACE_LDFLAGS:pn-rmfpodmgr = " -lbreakpadwrapper "
BACKTRACE_LDFLAGS:pn-parodus = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-tr69hostif = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-rdkservices = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-webkitbrowser-plugin = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-cobalt-plugin = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-browserlauncher = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-wpeframework-plugin-netflix = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-wpa-supplicant = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-hdmicec = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-devicesettings = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-trmmgr = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-wsproxy = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-qtapp = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-ledmgr = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-audiocapturemgr = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-audioserver = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-audioserver-soc= " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-runpod = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-runsnmp = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-vodclient-app = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-nlmon = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-pwr-state-monitor = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-authservice = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-aml-audio-service = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-asbluetoothrcu  = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-dnsmasq = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-rdkfwupgrader = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-libloader-app = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-wpe-webkit = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-cobaltlauncher = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-dcmd = " -lbreakpadwrapper "
BACKTRACE_LDFLAGS:pn-rfc = " -Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "
BACKTRACE_LDFLAGS:pn-wpeframework = "-Wl,--no-as-needed -lbreakpadwrapper -Wl,--as-needed "

DEPENDS:append = " ${@LOG_BACKTRACE == "y" and BACKTRACE_DEPENDS or ""}"
LDFLAGS:append = " ${@LOG_BACKTRACE == "y" and BACKTRACE_LDFLAGS or ""}"
